{"ast":null,"code":"import _slicedToArray from\"/Users/drew/Documents/Development/Morgan_Site/MoShops/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _defineProperty from\"/Users/drew/Documents/Development/Morgan_Site/MoShops/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _toConsumableArray from\"/Users/drew/Documents/Development/Morgan_Site/MoShops/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"/Users/drew/Documents/Development/Morgan_Site/MoShops/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import React,{useReducer,useState,useEffect}from'react';import{IonCard,IonCardHeader,IonCardTitle,IonCardSubtitle,IonCardContent,IonList,IonItemDivider,IonItem,IonInput,IonLabel,IonSelect,IonImg,IonSelectOption,IonButton,IonGrid,IonRow,IonCol,IonIcon}from'@ionic/react';import firebase from'../../Firebase';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";;;;var imageStateInitial={imageName:\"\",imageFullPath:\"\",imageDescription:\"test\",imageUrl:\"\"};var portfolioStateInitial={itemName:'',itemDescription:'',creationDate:'',imgLocation:\"\",groupLocation:\"\"};var reducer=function reducer(state,action){switch(action.type){case'spread':return _objectSpread({},action.payload);case'dbReplace':return _objectSpread({},action.payload);case'selectedImages':return _objectSpread(_objectSpread({},state),{},{'selectedImages':[].concat(_toConsumableArray(state.selectedImages),[action.payload])});default:return _objectSpread(_objectSpread({},state),{},_defineProperty({},action.type,action.payload));}};var CreatePortfolioEntryCard=function CreatePortfolioEntryCard(_ref){var name=_ref.name;//blueprint for database entries for reference\n//declaring multiple state variables\n//state has portfolioId, pictureGroupId, inventoryId\nvar _useReducer=useReducer(reducer,portfolioStateInitial),_useReducer2=_slicedToArray(_useReducer,2),portfolioState=_useReducer2[0],portfolioDispatch=_useReducer2[1];var _useReducer3=useReducer(reducer,imageStateInitial),_useReducer4=_slicedToArray(_useReducer3,2),imageState=_useReducer4[0],imageDispatch=_useReducer4[1];var _useReducer5=useReducer(reducer,{}),_useReducer6=_slicedToArray(_useReducer5,2),allStorageImgs=_useReducer6[0],updateAllStorageImgs=_useReducer6[1];var _useReducer7=useReducer(reducer,{}),_useReducer8=_slicedToArray(_useReducer7,2),allDbImages=_useReducer8[0],updateDbImages=_useReducer8[1];var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),selectedImg=_useState2[0],updateSelectedImg=_useState2[1];//const [imgBank, updateImgBank] = useReducer(reducer, {selectedImages:[]})\nvar _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),imgBank=_useState4[0],updateImgBank=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),selectedGroup=_useState6[0],updateSelectedGroup=_useState6[1];var storageRef=firebase.fbApp.storage().ref();var database=firebase.fbApp.database();var listRef=storageRef.child('pictures');var onChangeHandlerPortfolio=function onChangeHandlerPortfolio(event){portfolioDispatch({type:event.target.name,payload:event.detail.value});};useEffect(function(){listRef.listAll().then(function(res){res.items.forEach(function(itemRef){itemRef.getDownloadURL().then(function(url){updateAllStorageImgs({type:itemRef.name,//@ts-ignore\npayload:{imageUrl:url,imageName:itemRef.name,imageFullPath:itemRef.fullPath}});});});}).catch(function(error){console.log('error getting pictures references');});database.ref('images/').once('value').then(function(snapshot){updateDbImages({type:\"dbReplace\",payload:snapshot.val()});});},[]);var pushNewPortfolioEntry=function pushNewPortfolioEntry(event){database.ref('portfolio/').push({itemName:portfolioState.itemName,itemDescription:portfolioState.itemDescription,imgArr:imgBank,creationDate:portfolioState.creationDate});};var onSelectDropdownImgPortfolio=function onSelectDropdownImgPortfolio(event){if(event.detail.value){console.log(\"[onSelectDropdownImgPortfolio]: \".concat(event.detail.value));//console.log(allDbImages)\nvar imageRef=allDbImages[event.detail.value];var newImgBank=[].concat(_toConsumableArray(imgBank),[event.detail.value]);updateImgBank(newImgBank);}};var removeImageHandler=function removeImageHandler(event,index){if(imgBank[index]){console.log(\"removing \".concat(imgBank[index]));var removedImage=imgBank.splice(index,1);updateImgBank(imgBank);}};var imageOptions=Object.entries(allStorageImgs).map(function(key,value){//@ts-ignore\nreturn/*#__PURE__*/_jsx(IonSelectOption,{value:key[0],children:key[1].imageName});});//console.log(dbImages)\nvar dbImageOptions=Object.entries(allDbImages).map(function(key,value){//console.log(key[0])\n//@ts-ignore\nreturn/*#__PURE__*/_jsx(IonSelectOption,{value:key[0],children:key[1].imageDescription});});//const selectedImages = false\nvar selectedImages=imgBank.map(function(selectedImg,index){console.log(\"[selectedImages]: selected image: \".concat(selectedImg));if(selectedImg){console.log(allDbImages[selectedImg].imageName);console.log(allStorageImgs);return/*#__PURE__*/_jsxs(IonRow,{children:[/*#__PURE__*/_jsx(IonCol,{size:\"2\",children:/*#__PURE__*/_jsx(IonImg,{src:allStorageImgs[allDbImages[selectedImg].imageName]?allStorageImgs[allDbImages[selectedImg].imageName].imageUrl:false})}),/*#__PURE__*/_jsx(IonCol,{className:\"ion-align-self-end\",children:/*#__PURE__*/_jsx(IonButton,{color:\"danger\",onClick:function onClick(e){return removeImageHandler(e,index);},children:/*#__PURE__*/_jsx(IonIcon,{name:\"close-circle\"})})})]});}});return/*#__PURE__*/_jsx(IonItem,{children:/*#__PURE__*/_jsxs(IonCard,{children:[/*#__PURE__*/_jsxs(IonCardHeader,{children:[/*#__PURE__*/_jsx(IonCardTitle,{children:\"Create Entry\"}),/*#__PURE__*/_jsx(IonCardSubtitle,{children:\"for Portfolio\"})]}),/*#__PURE__*/_jsx(IonCardContent,{children:/*#__PURE__*/_jsx(IonItem,{children:/*#__PURE__*/_jsxs(IonList,{children:[/*#__PURE__*/_jsx(IonItemDivider,{color:\"secondary\",children:\"Details\"}),/*#__PURE__*/_jsxs(IonItem,{children:[/*#__PURE__*/_jsx(IonLabel,{children:\"Name: \"}),/*#__PURE__*/_jsx(IonInput,{value:portfolioState.itemName,name:\"itemName\",placeholder:\"...\",onIonChange:function onIonChange(e){return onChangeHandlerPortfolio(e);}})]}),/*#__PURE__*/_jsxs(IonItem,{children:[/*#__PURE__*/_jsx(IonLabel,{children:\"Description: \"}),/*#__PURE__*/_jsx(IonInput,{value:portfolioState.itemDescription,name:\"itemDescription\",placeholder:\"...\",onIonChange:function onIonChange(e){return onChangeHandlerPortfolio(e);}})]}),/*#__PURE__*/_jsxs(IonItem,{children:[/*#__PURE__*/_jsx(IonLabel,{children:\"Creation Date: \"}),/*#__PURE__*/_jsx(IonInput,{value:portfolioState.creationDate,name:\"creationDate\",placeholder:\"...\",onIonChange:function onIonChange(e){return onChangeHandlerPortfolio(e);}})]}),/*#__PURE__*/_jsx(IonItemDivider,{color:\"secondary\",children:\"Link to Pictures / Groups\"}),/*#__PURE__*/_jsxs(IonItem,{children:[\"Image Location: \",portfolioState.imgLocation]}),/*#__PURE__*/_jsxs(IonItem,{children:[/*#__PURE__*/_jsx(IonLabel,{children:\"Selected Images:\"}),/*#__PURE__*/_jsx(IonSelect,{value:selectedImg,okText:\"Okay\",cancelText:\"Dismiss\",onIonChange:function onIonChange(e){return onSelectDropdownImgPortfolio(e);},children:dbImageOptions})]}),/*#__PURE__*/_jsx(IonItem,{children:/*#__PURE__*/_jsx(IonGrid,{fixed:true,children:/*#__PURE__*/_jsx(IonRow,{children:selectedImages?selectedImages:'not loaded'})})}),/*#__PURE__*/_jsx(IonItem,{children:/*#__PURE__*/_jsx(IonButton,{color:\"seccondary\",onClick:function onClick(e){return pushNewPortfolioEntry(e);},children:\"Create!\"})})]})})})]})});};export default CreatePortfolioEntryCard;","map":{"version":3,"sources":["/Users/drew/Documents/Development/Morgan_Site/MoShops/src/components/CRUDcards/CreatePortfolioEntryCard.tsx"],"names":["React","useReducer","useState","useEffect","IonCard","IonCardHeader","IonCardTitle","IonCardSubtitle","IonCardContent","IonList","IonItemDivider","IonItem","IonInput","IonLabel","IonSelect","IonImg","IonSelectOption","IonButton","IonGrid","IonRow","IonCol","IonIcon","firebase","imageStateInitial","imageName","imageFullPath","imageDescription","imageUrl","portfolioStateInitial","itemName","itemDescription","creationDate","imgLocation","groupLocation","reducer","state","action","type","payload","selectedImages","CreatePortfolioEntryCard","name","portfolioState","portfolioDispatch","imageState","imageDispatch","allStorageImgs","updateAllStorageImgs","allDbImages","updateDbImages","selectedImg","updateSelectedImg","imgBank","updateImgBank","selectedGroup","updateSelectedGroup","storageRef","fbApp","storage","ref","database","listRef","child","onChangeHandlerPortfolio","event","target","detail","value","listAll","then","res","items","forEach","itemRef","getDownloadURL","url","fullPath","catch","error","console","log","once","snapshot","val","pushNewPortfolioEntry","push","imgArr","onSelectDropdownImgPortfolio","imageRef","newImgBank","removeImageHandler","index","removedImage","splice","imageOptions","Object","entries","map","key","dbImageOptions","e"],"mappings":"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","sourcesContent":["import React, { useReducer, useState, useEffect } from 'react';\n\nimport { IonContent, IonCard, IonCardHeader, IonCardTitle, IonCardSubtitle, IonCardContent, IonList, IonItemDivider, IonItem, IonInput, IonLabel, IonSelect, IonImg, IonSelectOption, IonButton, IonGrid, IonRow, IonCol, IonIcon } from '@ionic/react';\nimport firebase from '../../Firebase';\n\ninterface ContainerProps {\n    name: string;\n}\ninterface PortfolioItem {\n    itemName: String\n    itemDescription: String\n    imgLocation: String\n    groupLocation: String\n    creationDate: String\n};\ninterface StoreItem {\n    itemName: String\n    itemDescription: String\n    imgLocation: String\n    groupLocation: String\n    price: String\n};\ninterface ImageItem {\n    imageName: String\n    imageFullPath: String\n    imageDescription: String\n    imageUrl: String\n\n}\ninterface PictureGroup {\n    //might need to be array of strings\n    imageId: String\n};\nconst imageStateInitial: ImageItem = {\n    imageName: \"\",\n    imageFullPath: \"\",\n    imageDescription: \"test\",\n    imageUrl: \"\"\n}\nconst portfolioStateInitial: PortfolioItem = {\n    itemName: '',\n    itemDescription: '',\n    creationDate: '',\n    imgLocation: \"\",\n    groupLocation: \"\"\n};\n\nconst reducer = (state: any, action: any) => {\n    switch (action.type) {\n        case 'spread':\n            return {\n                ...action.payload\n            }\n        case 'dbReplace':\n            return {\n                ...action.payload\n            }\n        case 'selectedImages':\n            return {\n                ...state,\n                'selectedImages': [\n                    ...state.selectedImages,\n                    action.payload\n                ],\n            }\n        default:\n            return {\n                ...state,\n                [action.type]: action.payload\n            }\n    }\n}\n\nconst CreatePortfolioEntryCard: React.FC<ContainerProps> = ({ name }) => {\n    //blueprint for database entries for reference\n\n    //declaring multiple state variables\n    //state has portfolioId, pictureGroupId, inventoryId\n    const [portfolioState, portfolioDispatch] = useReducer(reducer, portfolioStateInitial)\n    const [imageState, imageDispatch] = useReducer(reducer, imageStateInitial)\n    const [allStorageImgs, updateAllStorageImgs] = useReducer(reducer, {})\n    const [allDbImages, updateDbImages] = useReducer(reducer, {})\n    const [selectedImg, updateSelectedImg] = useState<string>(\"\")\n    //const [imgBank, updateImgBank] = useReducer(reducer, {selectedImages:[]})\n    const [imgBank, updateImgBank] = useState<Array<string>>([])\n    const [selectedGroup, updateSelectedGroup] = useState<string>()\n    const storageRef = firebase.fbApp.storage().ref();\n    const database = firebase.fbApp.database()\n    var listRef = storageRef.child('pictures');\n\n\n\n    const onChangeHandlerPortfolio = (event: any) => {\n        portfolioDispatch({\n            type: event.target.name,\n            payload: event.detail.value,\n        })\n    }\n    useEffect(() => {\n        listRef.listAll().then(function (res) {\n            res.items.forEach(function (itemRef) {\n                itemRef.getDownloadURL().then(function (url) {\n                    updateAllStorageImgs({\n                        type: itemRef.name,\n                        //@ts-ignore\n                        payload: {\n                            imageUrl: url,\n                            imageName: itemRef.name,\n                            imageFullPath: itemRef.fullPath\n                        }\n                    });\n                })\n\n            });\n        }).catch(function (error) {\n            console.log('error getting pictures references')\n        });\n        database.ref('images/').once('value').then(function (snapshot) {\n            updateDbImages({\n                type: \"dbReplace\",\n                payload: snapshot.val()\n            });\n        })\n    }, [])\n\n    const pushNewPortfolioEntry = (event: any) => {\n        database.ref('portfolio/').push({\n            itemName: portfolioState.itemName,\n            itemDescription: portfolioState.itemDescription,\n            imgArr: imgBank,\n            creationDate: portfolioState.creationDate\n        })\n    }\n\n    const onSelectDropdownImgPortfolio = (event: any) => {\n        if (event.detail.value) {\n            console.log(`[onSelectDropdownImgPortfolio]: ${event.detail.value}`)\n            //console.log(allDbImages)\n            const imageRef = allDbImages[event.detail.value]\n            const newImgBank = [...imgBank, event.detail.value]\n            updateImgBank(newImgBank)\n        }\n    }\n    const removeImageHandler = (event: React.MouseEvent<HTMLIonButtonElement, MouseEvent>, index: number) => {\n        if(imgBank[index]){\n        console.log(`removing ${imgBank[index]}`);\n        const removedImage = imgBank.splice(index, 1);\n        updateImgBank(imgBank);\n        }\n    }\n    const imageOptions = Object.entries(allStorageImgs).map((key, value) => {\n        //@ts-ignore\n        return <IonSelectOption value={key[0]}>{key[1].imageName}</IonSelectOption>\n    })\n    //console.log(dbImages)\n    const dbImageOptions = Object.entries(allDbImages).map((key, value) => {\n        //console.log(key[0])\n        //@ts-ignore\n        return <IonSelectOption value={key[0]}>{key[1].imageDescription}</IonSelectOption>\n    })\n    //const selectedImages = false\n    const selectedImages = imgBank.map((selectedImg: string | number, index: number) => {\n        console.log(`[selectedImages]: selected image: ${selectedImg}`)\n        if (selectedImg) {\n            console.log(allDbImages[selectedImg].imageName)\n            console.log(allStorageImgs)\n            return <IonRow>\n                <IonCol size=\"2\">\n                    <IonImg src={allStorageImgs[allDbImages[selectedImg].imageName] ? allStorageImgs[allDbImages[selectedImg].imageName].imageUrl : false} />\n                </IonCol>\n                <IonCol className=\"ion-align-self-end\">\n                    <IonButton color=\"danger\" onClick={(e) => removeImageHandler(e, index)}>\n                        <IonIcon name=\"close-circle\" />\n                    </IonButton>\n\n                </IonCol>\n\n            </IonRow>\n        }\n    });\n\n    return (\n        <IonItem>\n\n            <IonCard>\n                <IonCardHeader>\n                    <IonCardTitle>Create Entry</IonCardTitle>\n                    <IonCardSubtitle>for Portfolio</IonCardSubtitle>\n                </IonCardHeader>\n                <IonCardContent>\n                    <IonItem>\n                        <IonList>\n                            <IonItemDivider color=\"secondary\">\n                                Details\n                </IonItemDivider>\n                            <IonItem>\n                                <IonLabel>Name: </IonLabel>\n                                <IonInput value={portfolioState.itemName} name='itemName' placeholder=\"...\" onIonChange={e => onChangeHandlerPortfolio(e!)}></IonInput>\n                            </IonItem>\n\n                            <IonItem>\n                                <IonLabel>Description: </IonLabel>\n                                <IonInput value={portfolioState.itemDescription} name='itemDescription' placeholder=\"...\" onIonChange={e => onChangeHandlerPortfolio(e!)}></IonInput>\n                            </IonItem>\n\n                            <IonItem>\n                                <IonLabel>Creation Date: </IonLabel>\n                                <IonInput value={portfolioState.creationDate} name='creationDate' placeholder=\"...\" onIonChange={e => onChangeHandlerPortfolio(e!)}></IonInput>\n                            </IonItem>\n                            <IonItemDivider color=\"secondary\">\n                                Link to Pictures / Groups\n                        </IonItemDivider>\n                            <IonItem>Image Location: {portfolioState.imgLocation}</IonItem>\n                            <IonItem>\n                                <IonLabel>Selected Images:</IonLabel>\n                                <IonSelect value={selectedImg} okText=\"Okay\" cancelText=\"Dismiss\" onIonChange={e => onSelectDropdownImgPortfolio(e!)}>\n                                    {dbImageOptions}\n                                </IonSelect>\n                            </IonItem>\n\n                            <IonItem>\n                                <IonGrid fixed>\n                                    <IonRow>\n                                        {selectedImages ? selectedImages : 'not loaded'}\n                                    </IonRow>\n                                </IonGrid>\n                            </IonItem>\n                            <IonItem>\n                                <IonButton\n                                    color=\"seccondary\" onClick={(e) => pushNewPortfolioEntry(e!)}>\n                                    Create!\n                            </IonButton>\n                            </IonItem>\n                        </IonList>\n                    </IonItem>\n                </IonCardContent>\n            </IonCard>\n\n        </IonItem>\n    )\n};\n\nexport default CreatePortfolioEntryCard;\n"]},"metadata":{},"sourceType":"module"}