{"ast":null,"code":"import _createForOfIteratorHelper from\"/Users/drew/Documents/Development/Morgan_Site/MoShops/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";import _slicedToArray from\"/Users/drew/Documents/Development/Morgan_Site/MoShops/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _defineProperty from\"/Users/drew/Documents/Development/Morgan_Site/MoShops/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/drew/Documents/Development/Morgan_Site/MoShops/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import React,{useReducer,useEffect,useState}from'react';import firebase from'../Firebase';import{IonItem,IonImg,IonCol,IonRow,IonGrid}from'@ionic/react';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var reducer=function reducer(state,action){switch(action.type){case'spread':return _objectSpread({},action.payload);case'dbReplace':return _objectSpread({},action.payload);default:return _objectSpread(_objectSpread({},state),{},_defineProperty({},action.type,action.payload));}};var PortfolioContainer=function PortfolioContainer(_ref){var pageName=_ref.pageName;var _useReducer=useReducer(reducer,{}),_useReducer2=_slicedToArray(_useReducer,2),allStorageImgs=_useReducer2[0],updateAllStorageImgs=_useReducer2[1];var _useReducer3=useReducer(reducer,{}),_useReducer4=_slicedToArray(_useReducer3,2),allPortfolioEntries=_useReducer4[0],updateAllPortfolioEntries=_useReducer4[1];var _useReducer5=useReducer(reducer,{}),_useReducer6=_slicedToArray(_useReducer5,2),allDbImages=_useReducer6[0],updateDbImages=_useReducer6[1];var _useReducer7=useReducer(reducer,{}),_useReducer8=_slicedToArray(_useReducer7,2),localImgs=_useReducer8[0],updateLocalImgs=_useReducer8[1];var _useState=useState(),_useState2=_slicedToArray(_useState,2),err=_useState2[0],updateErr=_useState2[1];var _useReducer9=useReducer(reducer,{}),_useReducer10=_slicedToArray(_useReducer9,2),portfolioItems=_useReducer10[0],updatePortfolioItems=_useReducer10[1];var storageRef=firebase.fbApp.storage().ref();var database=firebase.fbApp.database();var listRef=storageRef.child('pictures');useEffect(function(){console.log(\"[useEffect] entering use effect\");listRef.listAll().then(function(res){res.items.forEach(function(itemRef){itemRef.getDownloadURL().then(function(url){updateAllStorageImgs({type:itemRef.name,//@ts-ignore\npayload:{imageUrl:url,imageName:itemRef.name,imageFullPath:itemRef.fullPath}});});});}).catch(function(error){console.log('error getting pictures references');updateErr('error getting pictures references');});database.ref('images/').once('value').then(function(snapshot){updateDbImages({type:\"dbReplace\",payload:snapshot.val()});});database.ref('portfolio/').once('value').then(function(snapshot){//console.log('[imagesDb] snapshot val;')\n//console.log(snapshot.val())\nupdateAllPortfolioEntries({type:\"dbReplace\",payload:snapshot.val()});});//console.log('[PortfolioContainer]: all entries:', allPortfolioEntries)\nconsole.log(\"[useEffect] all portfolio entries\",allPortfolioEntries);},[]);//Trying to create the portfolio matrix to transpose on teh responsive grid. Only need to update on completion of updateAllPortfolioEntreies\nuseEffect(function(){var allPortfolioItems=Object.entries(allPortfolioEntries).map(function(key,value){//@ts-ignore\nvar _key$=key[1],itemName=_key$.itemName,creationDate=_key$.creationDate,itemDescription=_key$.itemDescription,imgArr=_key$.imgArr;if(allStorageImgs[allDbImages[imgArr[0]].imageName]){var imgUrl=allStorageImgs[allDbImages[imgArr[0]].imageName].imageUrl;var width=allStorageImgs[allDbImages[imgArr[0]].imageName].imageWidth;var height=allStorageImgs[allDbImages[imgArr[0]].imageName].imageHeight;var date=allDbImages[imgArr[0]].creationDate;var newItem={imgUrl:imgUrl,width:width,height:height,date:date};return newItem;}});console.log(\"[useEffect2] all portfolio items\",allPortfolioItems);updatePortfolioItems({type:'myArr',payload:allPortfolioItems});buildPortfolioMatrix();},[allPortfolioEntries]);var colWidth=0;var maxWidth=1000;var buildPortfolioMatrix=function buildPortfolioMatrix(){//start with row\n//add image column\n//add dimensions to colWidth\n//if max width break\n//end with row\nvar sortedArr=portfolioItems.myArr||[];var _iterator=_createForOfIteratorHelper(sortedArr),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var item=_step.value;console.log(\"[buildMatrix]: item width \".concat(item.width));}}catch(err){_iterator.e(err);}finally{_iterator.f();}};var gridItems=function gridItems(){//@ts-ignore\nvar returnArr=[/*#__PURE__*/_jsx(IonItem,{})];//console.log(portfolioItems)\nif(portfolioItems.myArr){var _iterator2=_createForOfIteratorHelper(portfolioItems.myArr),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var item=_step2.value;if(item&&item.imgUrl!=undefined){//console.log('entering thing')\nif(colWidth==0){//console.log(`[gridItems] creating item`)\nreturnArr.push(/*#__PURE__*/_jsx(IonRow,{children:/*#__PURE__*/_jsx(IonCol,{size:\"3\",children:/*#__PURE__*/_jsx(IonItem,{children:/*#__PURE__*/_jsx(IonImg,{src:item.imgUrl})})})}));}}}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}return returnArr;}};return/*#__PURE__*/_jsxs(IonGrid,{children:[gridItems(),/*#__PURE__*/_jsx(IonRow,{children:/*#__PURE__*/_jsxs(IonItem,{children:[\"Error Code: \",err?err:'none']})})]});};export default PortfolioContainer;","map":{"version":3,"sources":["/Users/drew/Documents/Development/Morgan_Site/MoShops/src/components/PortfolioContainer.tsx"],"names":["React","useReducer","useEffect","useState","firebase","IonItem","IonImg","IonCol","IonRow","IonGrid","reducer","state","action","type","payload","PortfolioContainer","pageName","allStorageImgs","updateAllStorageImgs","allPortfolioEntries","updateAllPortfolioEntries","allDbImages","updateDbImages","localImgs","updateLocalImgs","err","updateErr","portfolioItems","updatePortfolioItems","storageRef","fbApp","storage","ref","database","listRef","child","console","log","listAll","then","res","items","forEach","itemRef","getDownloadURL","url","name","imageUrl","imageName","imageFullPath","fullPath","catch","error","once","snapshot","val","allPortfolioItems","Object","entries","map","key","value","itemName","creationDate","itemDescription","imgArr","imgUrl","width","imageWidth","height","imageHeight","date","newItem","buildPortfolioMatrix","colWidth","maxWidth","sortedArr","myArr","item","gridItems","returnArr","undefined","push"],"mappings":"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","sourcesContent":["import React, { useReducer, useEffect, useState, ReactChild } from 'react';\nimport firebase from '../Firebase'\nimport { IonItem, IonImg, IonCol, IonRow, IonGrid } from '@ionic/react';\n\n\ninterface ContainerProps {\n  pageName: string;\n}\n\ninterface PortfolioItem {\n  imgUrl: string;\n  width: number;\n  height: number;\n  date: string;\n}\n\nconst reducer = (state: any, action: any) => {\n  switch (action.type) {\n    case 'spread':\n      return {\n        ...action.payload\n      }\n    case 'dbReplace':\n      return {\n        ...action.payload\n      }\n    default:\n      return {\n        ...state,\n        [action.type]: action.payload\n      }\n  }\n}\n\nconst PortfolioContainer: React.FC<ContainerProps> = ({ pageName }) => {\n  const [allStorageImgs, updateAllStorageImgs] = useReducer(reducer, {})\n  const [allPortfolioEntries, updateAllPortfolioEntries] = useReducer(reducer, {})\n  const [allDbImages, updateDbImages] = useReducer(reducer, {})\n  const [localImgs, updateLocalImgs] = useReducer(reducer, {})\n  const [err, updateErr] = useState<string>();\n  const [portfolioItems, updatePortfolioItems] = useReducer(reducer, {})\n  const storageRef = firebase.fbApp.storage().ref();\n  const database = firebase.fbApp.database()\n  var listRef = storageRef.child('pictures');\n  useEffect(() => {\n    console.log(`[useEffect] entering use effect`)\n    listRef.listAll().then(function (res) {\n      res.items.forEach(function (itemRef) {\n        itemRef.getDownloadURL().then(function (url) {\n          updateAllStorageImgs({\n            type: itemRef.name,\n            //@ts-ignore\n            payload: {\n              imageUrl: url,\n              imageName: itemRef.name,\n              imageFullPath: itemRef.fullPath\n            }\n          });\n        })\n      });\n    }).catch(function (error) {\n      console.log('error getting pictures references')\n      updateErr('error getting pictures references')\n    });\n    database.ref('images/').once('value').then(function (snapshot) {\n      updateDbImages({\n        type: \"dbReplace\",\n        payload: snapshot.val()\n      });\n    })\n    database.ref('portfolio/').once('value').then(function (snapshot) {\n      //console.log('[imagesDb] snapshot val;')\n      //console.log(snapshot.val())\n      updateAllPortfolioEntries({\n        type: \"dbReplace\",\n        payload: snapshot.val()\n      });\n    });\n    //console.log('[PortfolioContainer]: all entries:', allPortfolioEntries)\n    console.log(`[useEffect] all portfolio entries`, allPortfolioEntries)\n    \n  }, []);\n  //Trying to create the portfolio matrix to transpose on teh responsive grid. Only need to update on completion of updateAllPortfolioEntreies\n  useEffect(()=> {\n    const allPortfolioItems = Object.entries(allPortfolioEntries).map((key, value) => {\n      //@ts-ignore\n      let { itemName, creationDate, itemDescription, imgArr } = key[1]\n\n      if (allStorageImgs[allDbImages[imgArr[0]].imageName]) {\n        const imgUrl = allStorageImgs[allDbImages[imgArr[0]].imageName].imageUrl;\n        const width = allStorageImgs[allDbImages[imgArr[0]].imageName].imageWidth;\n        const height = allStorageImgs[allDbImages[imgArr[0]].imageName].imageHeight;\n        const date = allDbImages[imgArr[0]].creationDate;\n        const newItem: PortfolioItem = {\n          imgUrl: imgUrl,\n          width: width,\n          height: height,\n          date: date\n        }\n        return newItem\n      }\n    })\n    console.log(`[useEffect2] all portfolio items`, allPortfolioItems)\n    updatePortfolioItems({\n      type: 'myArr',\n      payload: allPortfolioItems\n    })\n    buildPortfolioMatrix()\n  }, [allPortfolioEntries])\n  let colWidth = 0;\n  const maxWidth = 1000\n  const buildPortfolioMatrix = () => {\n    //start with row\n    //add image column\n    //add dimensions to colWidth\n    //if max width break\n    //end with row\n    let sortedArr = portfolioItems.myArr || []\n    for (const item of sortedArr){\n      console.log(`[buildMatrix]: item width ${item.width}`)\n    }\n  }\n  \n  const gridItems = () => {\n    //@ts-ignore\n    let returnArr: [ReactChild] = [<IonItem></IonItem>];\n    //console.log(portfolioItems)\n    if (portfolioItems.myArr) {\n      for (const item of portfolioItems.myArr) {\n        if (item && item.imgUrl!=undefined) {\n          //console.log('entering thing')\n          if (colWidth == 0) {\n            //console.log(`[gridItems] creating item`)\n            returnArr.push(<IonRow>\n              <IonCol size='3' >\n                <IonItem>\n                  <IonImg src={item.imgUrl} />\n                </IonItem>\n              </IonCol>\n            </IonRow>)\n          }\n          \n        }\n      }\n      return returnArr\n    }\n  }\n\n  return (\n    <IonGrid>\n  \n        {gridItems()}\n      \n      <IonRow><IonItem>Error Code: {err?err:'none'}</IonItem></IonRow>\n    </IonGrid>\n  );\n};\n\nexport default PortfolioContainer;\n"]},"metadata":{},"sourceType":"module"}